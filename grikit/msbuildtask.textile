To simplify the calling of the MSBuild.exe, the MSBuildTask can be used in a rakefile. Be sure to require 'albacore' at the top of your rakefile, after installing the Albacore gem.

h2. How to use the MSBuildTask

Here is an example of how to use the MSBuildTask

<pre><code>
desc "Run a sample build using the MSBuildTask"
Rake::MSBuildTask.new(:msbuild) do |msb|
  msb.properties :configuration => :Debug
  msb.targets [:Clean, :Build]
  msb.solution = "lib/spec/support/TestSolution/TestSolution.sln"
end
</code></pre>

h3. Initializer Parameter: task name (optional)

The default rake task name is "msbuild". You can specify any name you wish, as the rake task name.

h3. path_to_command (required)

You can specify the location of the MSBuild.exe that you wish to use. If you do not provide a location, then the task will default to using the MSBuild.exe that is included in the .net 3.5 framework.

If an invalid or incorrect msbuild path is specified (i.e. if the file or folder specified does not exist), the MSBuildTask will fail with an exception stating that the msbuild file was not found:

<pre><code>F, [2009-10-04T14:01:33.481000 #5436] FATAL -- : Command not found: i don't exist.exe
F, [2009-10-04T14:01:33.481000 #5436] FATAL -- : MSBuild Failed. See Build Log For Detail
rake aborted!
</code></pre>

h3. solution (required)

This is the solution file or msbuild file that you are going to build. This is the one setting for MSBuild that is required. If you don't provide a valid visual studio solution or msbuild file, you will get an error.

If not solution is provided, the MSBuiltTask will fail with an exception stating that the solution cannot be nil.

<pre><code>F, [2009-09-28T09:42:48.405000 #1048] FATAL -- : solution cannot be nil
rake aborted!
solution cannot be nil
</code></pre>

h3. properties (optional)

You can specify any valid MSBuild command line property, here, as a hash literal. For example, if you wanted to provide a property called "foo" with a value of "bar", and a property called "widget" with a value of "wombat", you would do so like this:

<pre><code>msb.properties :foo => :bar, :widget => :wombat</code></pre>

You are not required to use :symbols for these values. You can provide string values if you wish. However, if you try to use data types such as "true" or "false", you must specify them as symbols or strings, directly. 

The properties setting is optional. If you don't provide any values for this, the defaults from your solution or msbuild file will be used.

h3. targets (optional)

You can specify any valid target for your solution or msbuild file, here, as an array. The example above is calling the Clean and then Build targets, in that order. If you only want to call Rebuild, as another example, you would set the targets like this:

<pre><code>msb.targets :Rebuild</code></pre>

You are not required to use :symbols for these values. You can provide string values if you wish. However, if you try to use data types such as "true" or "false", you must specify them as symbols or strings, directly. 

The properties setting is optional. If you don't provide any values for this, the defaults from your solution or msbuild file will be used.

h3. verbosity (optional)

Sets the msbuild "/verbosity" parameter to the specified value. 

<pre><code>msb.verbosity = "normal"</code></pre>

This option is separate from the logging options below, as it pertains to the msbuild parameter directly. The logging options below refer to the msbuild task object model.

h3. Logging

The MSBuildTask uses the built in [[loggingoptions|logging options]] to provide some potentially useful information at run-time. By default, no additional information is logged, other than what MSBuild produces.

h4. verbose mode

When the log_level is set to :verbose, the full command line call for MSBuild will be logged. This includes the expanded path to the msbuild exe as well as the command line parameters that are passed to it.

<pre><code>D, [2009-09-28T09:18:22.254000 #7152] DEBUG -- : Executing MSBuild: "C:\Windows/Microsoft.NET/Framework/v3.5/MSBuild.exe" "TestSolution/TestSolution.sln" /property:configuration=Debug /target:Clean;Build
</code></pre>
